<script>
    var TopicListItem = require('discourse/components/topic-list-item').default;
    var computed = require('ember-addons/ember-computed-decorators').default;
    var findRawTemplate = require('discourse/lib/raw-templates').findRawTemplate;
    TopicListItem.reopen({
        buildBuffer: function (buffer) {
            var template = findRawTemplate('topic-list-item-override');
            if (template) {
                buffer.push(template(this));
            }
        }
    });
</script>
<script type='text/x-handlebars' data-template-name='topic-list-item-override.raw'>
    <div class="post-card">
        <div class="post-card-head">
            <a href="{{topic.posters.firstObject.user.path}}" data-user-card="{{topic.posters.firstObject.user.username}}">
                {{avatar topic.posters.firstObject avatarTemplatePath="user.avatar_template" usernamePath="user.username" imageSize="small"}}
            </a>
            <span class="head-detail">
                <div class="post-title">
                    {{topic-link topic class="raw-link raw-topic-link"}}
                    {{raw "list/activity-column" topic=topic class="post-activity" tagName="span"}}
                </div>
                <div class="post-tags">
                    <a class="category-badge" href="{{topic.category.url}}">{{topic.category.name}}</a>
                    {{discourse-tags topic mode="list" tagsForUser=tagsForUser}}
                </div>
            <span>
        </div>
        {{#if topic.hasExcerpt}}
        <div class="post-body">{{dir-span topic.escapedExcerpt}}</div>
        {{/if}}
        <div class="post-footer">
            <span class="post-views">
                <svg style="width:14px;height:14px" viewBox="0 0 24 24">
                    <path fill="#999999" d="M21,5C19.89,4.65 18.67,4.5 17.5,4.5C15.55,4.5 13.45,4.9 12,6C10.55,4.9 8.45,4.5 6.5,4.5C4.55,4.5 2.45,4.9 1,6V20.65C1,20.9 1.25,21.15 1.5,21.15C1.6,21.15 1.65,21.1 1.75,21.1C3.1,20.45 5.05,20 6.5,20C8.45,20 10.55,20.4 12,21.5C13.35,20.65 15.8,20 17.5,20C19.15,20 20.85,20.3 22.25,21.05C22.35,21.1 22.4,21.1 22.5,21.1C22.75,21.1 23,20.85 23,20.6V6C22.4,5.55 21.75,5.25 21,5M21,18.5C19.9,18.15 18.7,18 17.5,18C15.8,18 13.35,18.65 12,19.5V8C13.35,7.15 15.8,6.5 17.5,6.5C18.7,6.5 19.9,6.65 21,7V18.5Z" />
                </svg>
                {{number topic.views numberKey="views_long"}}
            </span>
            <span class="post-participants">
                <svg style="width:14px;height:14px" viewBox="0 0 24 24">
                    <path fill="#999999" d="M12,23A1,1 0 0,1 11,22V19H7A2,2 0 0,1 5,17V7A2,2 0 0,1 7,5H21A2,2 0 0,1 23,7V17A2,2 0 0,1 21,19H16.9L13.2,22.71C13,22.89 12.76,23 12.5,23H12M3,15H1V3A2,2 0 0,1 3,1H19V3H3V15Z" />
                </svg>
                {{number topic.replyCount noTitle="true"}}
            </span>
            <span class="post-like">{{d-icon "heart"}} {{number topic.like_count}}</span>
            <span class="post-bookmark">{{d-icon "bookmark"}} {{number topic.like_count}}</span>
            <a class="last-poster" href="{{topic.posters.lastObject.user.path}}" data-user-card="{{topic.posters.lastObject.user.username}}">
                最后回复{{avatar topic.posters.lastObject avatarTemplatePath="user.avatar_template" usernamePath="user.username" imageSize="small"}}
            </a>
        </div>
    </div>
</script>
<script type="text/x-handlebars" data-template-name="components/topic-list">
    {{#each filteredTopics as |topic|}}
        {{topic-list-item topic=topic
                          bulkSelectEnabled=bulkSelectEnabled
                          showTopicPostBadges=showTopicPostBadges
                          hideCategory=hideCategory
                          showPosters=showPosters
                          showParticipants=showParticipants
                          showLikes=showLikes
                          showOpLikes=showOpLikes
                          expandGloballyPinned=expandGloballyPinned
                          expandAllPinned=expandAllPinned
                          lastVisitedTopic=lastVisitedTopic
                          selected=selected
                          tagsForUser=tagsForUser}}
    {{/each}}
</script>
